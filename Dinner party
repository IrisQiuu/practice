---
title: " Dinner party"
author: "Chenyu Qiu"
date: "3/25/2019"
output: html_document
---
##1.introduction
Suppose you are at a dinner party. The host wants to give out a door prize
that is wrapped in a box. Everyone (including the host) sits around a
circular table and each person is given a fair coin. Initially the host is
holding the box. He/she flips his coin. If it is heads, the box is passed to
the right; if it is tails, it is passed to the left. The process is repeated by
whichever guest is holding the box. (Heads, they pass right; tails, they pass
left.) The game ends when the last person to receive the box finally gets it
for the first time. That person gets to keep the box as the winner of the
game.Where should you sit to maximize your chance of winning?

##2.Code
set.seed(2019)
DinnerParty <- function(nperson, ntrial, pheads){
  
  #set up some variables
  winner <- rep(0, nperson)
  ntoss <- rep(0, ntrial)
  result <- data.frame(winner, ntoss)
  ntouchedthegift <- rep(0,nperson)
  
  #the loop to play the game
  for (i in 1:ntrial) {
    
    #initialize
    toss <- 0
    ntouchedthegift <- rep(0,nperson)
    ntouchedthegift[1] <- 1
    hasthegift <- 1
    
    
    while (length(which(ntouchedthegift == 1)) < nperson){
      #toss the coin
      coin <- c(-1, 1)
      cointoss <- sample(coin, 1, TRUE, c(1-pheads, pheads))
      toss <- toss+1
      #move the gift
      if (cointoss == 1){ #move to the right
        hasthegift <- hasthegift+1
        if (hasthegift==nperson+1){
          hasthegift <- 1
        }
      }else if (cointoss == -1){ #move to the left
        hasthegift <- hasthegift-1
        if (hasthegift == 0){
          hasthegift <- nperson
        }
      }
      ntouchedthegift[hasthegift] <- 1 #record who touched the gift
    }
    #store the result
    result[i,1] <- hasthegift
    result[i,2] <- toss
  }
  return(result)
}

#call the function
game <- DinnerParty(10, 100000, 0.5)
winthegift <- game[,1]
numberoftoss <- game[,2]

#plot histogram
hist(winthegift, breaks = c(0:10),col = "gray")
abline(h=100000/9,col="red4",lwd=2)
hist(numberoftoss, col = "gray")

#summarize
table(winthegift)
summary(numberoftoss)
